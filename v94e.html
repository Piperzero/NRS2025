<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NRS 2025 ASEAN Coverage Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #CDD7E3 0%, #ADC7F8 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
      margin: 0;
      flex-direction: column;
    }
    
    html, body {
      overflow-x: hidden;
      max-width: 100vw;
    }

    .widget-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      padding: 40px;
      max-width: 700px;
      width: 100%;
      margin: auto;
      position: relative;
      overflow: hidden;
    }
    
    /* Landing Page Styles */
    .landing-container {
      text-align: center;
      padding: 40px 20px;
      min-height: 70vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .landing-header {
      margin-bottom: 40px;
    }
    
    .landing-title {
      font-size: 2.8rem;
      margin-bottom: 15px;
      background: #5A7ED8;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: bold;
    }
    
    .landing-subtitle {
      font-size: 1.3rem;
      color: #555;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .landing-tagline {
      font-size: 1rem;
      color: #666;
      margin-bottom: 30px;
    }
    
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 25px;
      margin: 30px 0 40px 0;
    }
    
    .feature-card {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .feature-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    }
    
    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 12px;
    }
    
    .feature-title {
      font-size: 1.1rem;
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
    }
    
    .feature-description {
      font-size: 0.9rem;
      color: #666;
      line-height: 1.4;
    }
    
    .get-started-btn {
      background: #5A7ED8;
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 30px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(90, 126, 216, 0.3);
      margin-top: 20px;
    }
    
    .get-started-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
    }
    
    .disclaimer-section {
      margin-top: 40px;
      text-align: center;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      font-style: italic;
    }

    .disclaimer-title {
      font-size: 1.0rem;
      font-weight: bold;
      color: #333;
      margin-bottom: 20px;
      text-decoration: underline;
    }

    .disclaimer-text {
      font-size: 0.8rem;
      color: #666;
      line-height: 1.4;
      margin-bottom: 15px;
      text-align: justify;
    }

    .asean-logo {
      position: absolute;
      top: 7px;
      right: 30px;
      width: 120px;
      height: auto;
      z-index: 10;
    }

    .pidm-nrs2 {
      position: absolute;
      top: 28px;
      left: 20px;
      height: 40px;
      width: auto;
      z-index: 10;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .asean-logo {
        width: 60px;
        top: 6px;
        right: 10px;
      }
  
      .pidm-nrs2 {
        height: 25px;
        top: 12px;
        left: 10px;
      }

      body {
        padding: 5px;
        align-items: flex-start;
        padding-top: 20px;
      }
  
      .widget-container {
        margin: 0;
        padding: 20px;
        max-width: 100%;
        width: calc(100% - 10px);
        box-sizing: border-box;
      }
  
      .landing-container {
        padding: 20px 10px;
      }
  
      .landing-title {
        font-size: 2.2rem;
      }
  
      .feature-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 2px;
      }
  
      .widget-container {
        width: calc(100% - 4px);
        padding: 15px;
      }
  
      .landing-title {
        font-size: 1.8rem;
      }
    }

    /* Main Page Styles */
    h1 {
      text-align: center;
      color: #5A7ED8;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 10px;
      font-weight: bold;
      color: #555;
    }
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
    .summary-dashboard {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      border-left: 6px solid #3b82f6;
      margin-top: 20px;
    }
    .dashboard-header {
      text-align: center;
      margin-bottom: 25px;
    }
    .dashboard-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin: 0;
    }
    .summary-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .summary-card {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .summary-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .summary-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }
    .summary-label {
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
      font-weight: 600;
      margin-bottom: 6px;
    }
    .summary-value {
      font-size: 16px;
      font-weight: bold;
      color: #333;
      word-break: break-word;
    }
    .coverage-main-card {
      background: white;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      border-left: 6px solid #ddd;
      transition: all 0.3s ease;
      margin-bottom: 20px;
    }
    .coverage-main-card.fully-covered {
      border-left-color: #10b981;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }
    .coverage-main-card.partially-covered {
      border-left-color: #f59e0b;
      background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
    }
    .coverage-main-card.no-coverage {
      border-left-color: #ef4444;
      background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
    }
    .coverage-status-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .coverage-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
    }
    .coverage-badge {
      padding: 8px 16px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: bold;
    }
    .badge-covered {
      background: #10b981;
      color: white;
    }
    .badge-partial {
      background: #f59e0b;
      color: white;
    }
    .badge-no-coverage {
      background: #ef4444;
      color: white;
    }
    .progress-container {
      background: #e5e7eb;
      border-radius: 10px;
      height: 12px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      border-radius: 10px;
      transition: width 0.8s ease;
    }
    .progress-covered {
      background: linear-gradient(90deg, #10b981, #34d399);
    }
    .progress-partial {
      background: linear-gradient(90deg, #f59e0b, #fbbf24);
    }
    .coverage-details-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .detail-card {
      background: rgba(255,255,255,0.7);
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      backdrop-filter: blur(10px);
    }
    .detail-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }
    .detail-label {
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .detail-value {
      font-size: 16px;
      font-weight: bold;
      color: #333;
    }
    .country-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }
    .country-option {
      border: 2px solid #ccc;
      padding: 10px;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
    }
    .country-option.selected {
      border-color: #4c51bf;
      background-color: #ebf4ff;
      box-shadow: 0 0 0 3px #a3bffa;
    }
    .country-option:hover {
      background-color: #eef5ff;
      border-color: #667eea;
    }
    .start-family-scenario-btn {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 25px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
      margin-top: 25px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .start-family-scenario-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }
    .page-header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #e5e7eb;
    }
    .back-button {
      background: linear-gradient(135deg, #6b7280, #4b5563);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 20px;
    }
    .back-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(107, 114, 128, 0.3);
    }
  </style>
</head>
<body>
  <div class="widget-container">
    <!-- PAGE 0: Landing Page -->
    <div class="page active" id="page0">
      <img src="https://raw.githubusercontent.com/Piperzero/NRS2025/main/asean-logo.png" alt="ASEAN Malaysia 2025" class="asean-logo">
      <img src="https://raw.githubusercontent.com/Piperzero/NRS2025/main/pidm-nrs2.png" alt="PIDM NRS 2025" class="pidm-nrs2">
      <div class="landing-container">
        <div class="landing-header">
          <h1 class="landing-title">ASEAN Coverage Calculator</h1>
          <p class="landing-subtitle">ASEAN+3 Deposit Insurance Protection</p>
          <p class="landing-tagline">Discover how your deposits are protected in 13 jurisdictions</p>
        </div>
        
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon">🌍</div>
            <div class="feature-title">13 Jurisdictions</div>
            <div class="feature-description">Comparison of coverage across ASEAN+3 countries</div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">💰</div>
            <div class="feature-title">Real-Time Analysis</div>
            <div class="feature-description">Instant calculation with currency conversion and coverage visualisation</div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">👨‍👩‍👧‍👦</div>
            <div class="feature-title">Family Edition</div>
            <div class="feature-description">Strategic distribution through joint accounts</div>
          </div>
        </div>
        
        <button class="get-started-btn" onclick="startTool()">
          Start Coverage Calculator
        </button>
        <div class="disclaimer-section">
          <h3 class="disclaimer-title">Disclaimer</h3>
          <p class="disclaimer-text">This "ASEAN Coverage Calculator" ("Calculator") is based on certain assumptions (including the currency exchange rates applied which are as of July 2025) and public information. Perbadanan Insurans Deposit Malaysia ("PIDM") makes no representations or warranties as to the accuracy, completeness, and reliability of the information generated by this Calculator. Please contact the deposit insurers from the relevant countries for more information on the deposit insurance in their respective jurisdiction.</p>
          <p class="disclaimer-text">The information generated by this Calculator is for general information only and does not in any way constitute any financial advice, guidance, or recommendation by PIDM. PIDM shall not be responsible for any consequential effect, nor be liable for any loss or damage howsoever caused arising out of of in connection with the use of this Calculator.</p>
        </div>
      </div>
    </div>

    <!-- PAGE 1: Main Deposit Insurance Tool -->
    <div class="page" id="page1">
      <h1>ASEAN Coverage Calculator</h1>
      <div class="form-group">
        <label for="amount">A. How much money do you wish to keep in a deposit account?</label>
        <input type="number" id="amount" placeholder="Enter amount in MYR (e.g. 10,000)" />
      </div>
      <div class="form-group">
        <label>B. Which jurisdiction do you wish to keep your deposits in?</label>
        <div class="country-grid" id="countryGrid"></div>
        <div style="margin-top: 15px; font-size: 13px; color: #666; font-style: italic; text-align: center; line-height: 1.4;">
          * Cambodia is currently working on a regulatory framework for a deposit protection scheme.
        </div>
      </div>
      <div class="summary">
        <div class="summary-dashboard">
          <div class="dashboard-header">
            <h2 class="dashboard-title">📋 Deposit Summary</h2>
          </div>
          <div class="summary-grid">
            <div class="summary-card">
              <div class="summary-icon">💰</div>
              <div class="summary-label">Deposit Amount</div>
              <div class="summary-value" id="summaryAmount">MYR 0.00</div>
            </div>
            <div class="summary-card">
              <div class="summary-icon">🌍</div>
              <div class="summary-label">Selected Jurisdiction</div>
              <div class="summary-value" id="summaryCountry">-</div>
            </div>
            <div class="summary-card">
              <div class="summary-icon">💱</div>
              <div class="summary-label">Converted Amount</div>
              <div class="summary-value" id="summaryConverted">-</div>
            </div>
            <div class="summary-card">
              <div class="summary-icon">🎯</div>
              <div class="summary-label">Deposit Insurance Coverage Limit</div>
              <div class="summary-value" id="summaryThreshold">-</div>
            </div>
          </div>
        </div>
      </div>
      <div class="coverage-box" id="coverageBox" style="display: none;">
        <div class="coverage-main-card" id="coverageMainCard">
          <div class="coverage-status-header">
            <div class="coverage-title">🛡️ Deposit Insurance Coverage</div>
            <div class="coverage-badge" id="coverageBadge">-</div>
          </div>
          <div class="progress-container">
            <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
          </div>
          <div class="coverage-details-grid">
            <div class="detail-card">
              <div class="detail-icon">🎯</div>
              <div class="detail-label">Deposit Insurance Coverage Limit</div>
              <div class="detail-value" id="coverageLimit">-</div>
            </div>
            <div class="detail-card">
              <div class="detail-icon">⚠️</div>
              <div class="detail-label">Uninsured Amount</div>
              <div class="detail-value" id="uncoveredAmount">-</div>
            </div>
          </div>
          <div id="myanmarFootnote" style="display: none; margin-top: 15px; padding-left: 20px; font-size: 13px; color: #666; font-style: italic; line-height: 1.4;">
            * Deposit insurance coverage is 60% of deposits between MMK100,000 to MMK1,000,000.
          </div>
        </div>
      </div>
      <div class="coverage-box" id="regionalCoverage" style="display: none; margin-top: 50px;">
        <h2>🌍 Regional Coverage Comparison</h2>
        <div id="regionalResults"></div>
      </div>
      <div class="coverage-box" id="familyScenarioPrompt" style="display: none; margin-top: 50px;">
        <div class="summary-dashboard">
          <div class="dashboard-header">
            <h2 class="dashboard-title">👨‍👩‍👧‍👦 Let's travel back to Malaysia...</h2>
          </div>
          <div style="text-align: center; margin: 20px 0;">
            <img src="https://raw.githubusercontent.com/Piperzero/NRS2025/main/my-map.png" alt="Malaysia Map" style="max-width: 50%; height: auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
          </div>
          <div class="summary-card" style="max-width: none; text-align: center; padding: 25px;">
            <p style="margin: 0 0 20px 0; font-size: 16px; line-height: 1.6; color: #555;">
              See how my family is protected by PIDM.
            </p>
            <button class="start-family-scenario-btn" onclick="goToFamilyScenario()">
              Start Family Scenario →
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    const amountInput = document.getElementById('amount');
    const summaryAmount = document.getElementById('summaryAmount');
    const summaryCountry = document.getElementById('summaryCountry');
    const summaryThreshold = document.getElementById('summaryThreshold');
    const summaryConverted = document.getElementById('summaryConverted');
    const coverageLimit = document.getElementById('coverageLimit');
    const coverageBadge = document.getElementById('coverageBadge');
    const coverageMainCard = document.getElementById('coverageMainCard');
    const progressBar = document.getElementById('progressBar');
    const uncoveredAmount = document.getElementById('uncoveredAmount');
    const coverageBox = document.getElementById('coverageBox');
    const regionalCoverage = document.getElementById('regionalCoverage');
    const regionalResults = document.getElementById('regionalResults');

    // Countries data
    const countries = [
      { name: 'Brunei Darussalam', flag: '🇧🇳', limit: 50000, currency: 'BND' },
      { name: 'Indonesia', flag: '🇮🇩', limit: 2000000000, currency: 'IDR' },
      { name: 'Lao PDR', flag: '🇱🇦', limit: 100000000, currency: 'LAK' },
      { name: 'Malaysia', flag: '🇲🇾', limit: 250000, currency: 'MYR' },
      { name: 'Myanmar', flag: '🇲🇲', limit: 1000000, currency: 'MMK' },
      { name: 'Philippines', flag: '🇵🇭', limit: 1000000, currency: 'PHP' },
      { name: 'Singapore', flag: '🇸🇬', limit: 100000, currency: 'SGD' },
      { name: 'Thailand', flag: '🇹🇭', limit: 1000000, currency: 'THB' },
      { name: 'Viet Nam', flag: '🇻🇳', limit: 125000000, currency: 'VND' },
      { name: "People's Republic of China", flag: '🇨🇳', limit: 500000, currency: 'CNY' },
      { name: 'Japan', flag: '🇯🇵', limit: 10000000, currency: 'JPY' },
      { name: 'Republic of Korea', flag: '🇰🇷', limit: 50000000, currency: 'KRW' }
    ];

    // Exchange rates
    const exchangeRates = {
      'MYR': 1, 'USD': 0.24, 'SGD': 0.303, 'THB': 7.68, 'IDR': 3834, 'PHP': 13.38,
      'VND': 6157, 'EUR': 0.20, 'GBP': 0.17, 'LAK': 5078, 'MMK': 494,
      'KRW': 326, 'JPY': 35.07, 'CNY': 1.69, 'BND': 0.30
    };

    // Utility functions
    function formatCurrency(value, currency = 'MYR') {
      return currency + ' ' + parseFloat(value).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function startTool() {
      console.log('startTool called');
      document.getElementById('page0').classList.remove('active');
      document.getElementById('page1').classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderCountryGrid() {
      const grid = document.getElementById('countryGrid');
      countries.forEach(country => {
        const div = document.createElement('div');
        div.className = 'country-option';
        div.innerHTML = '<div style="font-weight: bold; margin-bottom: 8px; font-size: 16px;">' + country.name + '</div>';
        div.onclick = () => selectCountry(country, div);
        grid.appendChild(div);
      });
    }

    function selectCountry(country, element) {
      document.querySelectorAll('.country-option').forEach(el => el.classList.remove('selected'));
      element.classList.add('selected');

      const amount = parseFloat(amountInput.value);
      if (!amount) return;

      const convertedAmount = amount * exchangeRates[country.currency];
      summaryAmount.textContent = formatCurrency(amount, 'MYR');
      summaryCountry.textContent = country.name;
      summaryThreshold.textContent = formatCurrency(country.limit, country.currency);
      summaryConverted.textContent = formatCurrency(convertedAmount, country.currency);

      const limit = country.limit;
      const limitInMYR = country.currency === 'MYR' ? limit : limit / exchangeRates[country.currency];
      
      const coverageTitle = document.querySelector('.coverage-title');
      if (coverageTitle) {
        coverageTitle.textContent = `🛡️ Deposit Insurance Coverage - ${country.name}`;
      }

      let actualCoverage, isFullyCovered, coveragePercentage;

      if (country.name === 'Myanmar') {
        const convertedAmount = amount * exchangeRates[country.currency];
  
        if (convertedAmount < 100000) {
          actualCoverage = 0;
          isFullyCovered = false;
          coveragePercentage = 0;
        } else if (convertedAmount <= 1000000) {
          const coverageInMMK = convertedAmount * 0.6;
          actualCoverage = coverageInMMK / exchangeRates[country.currency];
          isFullyCovered = false;
          coveragePercentage = 60;
        } else {
          const coverageInMMK = 1000000 * 0.6;
          actualCoverage = coverageInMMK / exchangeRates[country.currency];
          isFullyCovered = false;
          const actualCoveragePercentage = (coverageInMMK / convertedAmount) * 100;
          coveragePercentage = actualCoveragePercentage;
        }
      } else {
        actualCoverage = Math.min(amount, limitInMYR);
        isFullyCovered = amount <= limitInMYR;
        coveragePercentage = Math.min(100, (limitInMYR / amount) * 100);
      }

      if (country.currency === 'MYR') {
        coverageLimit.textContent = formatCurrency(limitInMYR, 'MYR');
      } else {
        coverageLimit.textContent = `${formatCurrency(limitInMYR, 'MYR')} (${formatCurrency(limit, country.currency)})`;
      }

      if (actualCoverage === 0) {
        coverageBadge.textContent = '⛔ No Coverage';
        coverageBadge.className = 'coverage-badge badge-no-coverage';
        coverageMainCard.className = 'coverage-main-card no-coverage';
        progressBar.style.width = '0%';
      } else if (isFullyCovered) {
        coverageBadge.textContent = '✅ Fully Covered';
        coverageBadge.className = 'coverage-badge badge-covered';
        coverageMainCard.className = 'coverage-main-card fully-covered';
        progressBar.className = 'progress-bar progress-covered';
        progressBar.style.width = '100%';
      } else {
        coverageBadge.textContent = country.name === 'Myanmar' ? 
          `🟡 60% Covered` : '🟡 Partially Covered';
        coverageBadge.className = 'coverage-badge badge-partial';
        coverageMainCard.className = 'coverage-main-card partially-covered';
        progressBar.className = 'progress-bar progress-partial';
        progressBar.style.width = coveragePercentage + '%';
      }

      const uninsuredMYR = amount - actualCoverage;
      const uninsuredLocal = uninsuredMYR * exchangeRates[country.currency];
      
      if (country.currency === 'MYR') {
        uncoveredAmount.textContent = formatCurrency(uninsuredMYR);
      } else {
        uncoveredAmount.textContent = `${formatCurrency(uninsuredMYR)} (${formatCurrency(uninsuredLocal, country.currency)})`;
      }

      coverageBox.style.display = 'block';
      
      const myanmarFootnote = document.getElementById('myanmarFootnote');
      if (myanmarFootnote) {
        myanmarFootnote.style.display = country.name === 'Myanmar' ? 'block' : 'none';
      }
      
      renderRegionalComparison(amount);
      document.getElementById('familyScenarioPrompt').style.display = 'block';
    }

    function renderRegionalComparison(amount) {
      regionalResults.innerHTML = '';
      
      const gridContainer = document.createElement('div');
      gridContainer.className = 'country-grid';
      gridContainer.style.marginTop = '15px';
      
      countries.forEach(country => {
        const limitInMYR = country.currency === 'MYR' ? country.limit : country.limit / exchangeRates[country.currency];
        let isFullyCovered;
        let hasCoverage = true;

        if (country.name === 'Myanmar') {
          const convertedAmount = amount * exchangeRates[country.currency];
          if (convertedAmount < 100000) {
            hasCoverage = false;
            isFullyCovered = false;
          } else if (convertedAmount <= 1000000) {
            hasCoverage = true;
            isFullyCovered = false;
          } else {
            hasCoverage = true;
            isFullyCovered = amount <= limitInMYR;
          }
        } else {
          isFullyCovered = amount <= limitInMYR;
        }

        const gridItem = document.createElement('div');
        gridItem.className = 'country-option';
        gridItem.style.cursor = 'default';
        
        let statusIcon, statusText, borderColor, backgroundColor, textColor;

        if (country.name === 'Myanmar') {
          if (!hasCoverage) {
            statusIcon = '⛔';
            statusText = 'No Coverage';
            borderColor = '#ef4444';
            backgroundColor = '#fef2f2';
            textColor = '#ef4444';
          } else {
            statusIcon = '🟡';
            statusText = '60% Covered';
            borderColor = '#f59e0b';
            backgroundColor = '#fffbeb';
            textColor = '#f59e0b';
          }
        } else {
          if (isFullyCovered) {
            statusIcon = '✅';
            statusText = 'Fully Covered';
            borderColor = '#10b981';
            backgroundColor = '#f0fdf4';
            textColor = '#10b981';
          } else {
            statusIcon = '🟡';
            statusText = 'Partially Covered';
            borderColor = '#f59e0b';
            backgroundColor = '#fffbeb';
            textColor = '#f59e0b';
          }
        }

        gridItem.style.border = `2px solid ${borderColor}`;
        gridItem.style.backgroundColor = backgroundColor;
        
        gridItem.innerHTML = `
          <div style="font-weight: bold; margin-bottom: 8px; font-size: 14px;">${country.name}</div>
          <div style="font-size: 12px; color: ${textColor}; font-weight: 600;">
            ${statusIcon} ${statusText}
          </div>
        `;
        
        gridContainer.appendChild(gridItem);
      });
      
      regionalResults.appendChild(gridContainer);
      regionalCoverage.style.display = 'block';
    }

    function goToFamilyScenario() {
      const amount = parseFloat(amountInput.value);
      if (!amount) {
        alert('Please complete Parts A and B first.');
        return;
      }
      
      // For now, just show an alert since we're testing the basic functionality
      alert('Family scenario would start here. Basic navigation is working!');
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded, initializing...');
      renderCountryGrid();

      // Add event listener for amount input
      if (amountInput) {
        amountInput.addEventListener('input', function() {
          const amount = parseFloat(this.value);
          if (amount && amount > 0) {
            summaryAmount.textContent = formatCurrency(amount, 'MYR');
            
            // Trigger country selection update if a country is already selected
            const selectedCountry = document.querySelector('.country-option.selected');
            if (selectedCountry) {
              const countryName = selectedCountry.textContent.trim();
              const country = countries.find(c => c.name === countryName);
              if (country) {
                selectCountry(country, selectedCountry);
              }
            }
          } else {
            summaryAmount.textContent = 'MYR 0.00';
            if (coverageBox) coverageBox.style.display = 'none';
            if (regionalCoverage) regionalCoverage.style.display = 'none';
            if (document.getElementById('familyScenarioPrompt')) document.getElementById('familyScenarioPrompt').style.display = 'none';
          }
        });
      }
    });
  </script>
</body>
</html>
